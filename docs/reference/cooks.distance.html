<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Influence on fixed effects of HLMs — mdffits.default • HLMdiag</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Influence on fixed effects of HLMs — mdffits.default" />
<meta property="og:description" content="These functions calculate measures of the change in the fixed effects
estimates based on the deletion of an observation, or group of 
observations, for a hierarchical linear model fit using lmer." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HLMdiag</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/hlm_resid.html">Residual Diagnostics</a>
    </li>
    <li>
      <a href="../articles/influence_diagnostics.html">Influence Diagnostics</a>
    </li>
    <li>
      <a href="../articles/jss_update.html">Updated JSS code</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/aloy/HLMdiag/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Influence on fixed effects of HLMs</h1>
    <small class="dont-index">Source: <a href='https://github.com/aloy/HLMdiag/blob/master/R/influence_functions.R'><code>R/influence_functions.R</code></a></small>
    <div class="hidden name"><code>cooks.distance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions calculate measures of the change in the fixed effects
estimates based on the deletion of an observation, or group of 
observations, for a hierarchical linear model fit using <code>lmer</code>.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for default</span>
<span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for mer</span>
<span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>model</span>, level <span class='op'>=</span> <span class='fl'>1</span>, delete <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for lmerMod</span>
<span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>model</span>, level <span class='op'>=</span> <span class='fl'>1</span>, delete <span class='op'>=</span> <span class='cn'>NULL</span>, include.attr <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for lme</span>
<span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>model</span>, level <span class='op'>=</span> <span class='fl'>1</span>, delete <span class='op'>=</span> <span class='cn'>NULL</span>, include.attr <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for mer</span>
<span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>object</span>, level <span class='op'>=</span> <span class='fl'>1</span>, delete <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for lmerMod</span>
<span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>object</span>, level <span class='op'>=</span> <span class='fl'>1</span>, delete <span class='op'>=</span> <span class='cn'>NULL</span>, include.attr <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for lme</span>
<span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>object</span>, level <span class='op'>=</span> <span class='fl'>1</span>, delete <span class='op'>=</span> <span class='cn'>NULL</span>, include.attr <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>fitted object of class <code>mer</code> or <code>lmerMod</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>do not use</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>fitted model of class <code>mer</code> or <code>lmerMod</code></p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>variable used to define the group for which cases will be
deleted.  If <code>level = 1</code> (default), then individual cases will be deleted.</p></td>
    </tr>
    <tr>
      <th>delete</th>
      <td><p>index of individual cases to be deleted. To delete specific 
observations the row number must be specified. To delete higher level
units the group ID and <code>group</code> parameter must be specified.
If <code>delete = NULL</code> then all cases are iteratively deleted.</p></td>
    </tr>
    <tr>
      <th>include.attr</th>
      <td><p>logical value determining whether the difference between 
the full and deleted parameter estimates should be included. If <code>FALSE</code> 
(default), a numeric vector of Cook's distance or MDFFITS is returned. 
If <code>TRUE</code>, a tibble with the Cook's distance or MDFFITS values in the 
first column and the parameter differences in the remaining columns is returned.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Both functions return a numeric vector (or single value if 
<code>delete</code> has been specified) as the default. If <code>include.attr = TRUE</code>, 
then a tibble is returned. The first column consists of the Cook's distance or
MDFFITS values, and the later columns capture the difference between the full
and deleted parameter estimates.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Both Cook's distance and MDFFITS measure the change in the 
fixed effects estimates based on the deletion of a subset of observations. 
The key difference between the two diagnostics is that Cook's distance uses
the covariance matrix for the fixed effects from the original
model while MDFFITS uses the covariance matrix from the deleted 
model.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Because MDFFITS requires the calculation of the covariance matrix
for the fixed effects for every model, it will be slower.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Christensen, R., Pearson, L., &amp; Johnson, W. (1992) 
Case-deletion diagnostics for mixed models. <em>Technometrics</em>, <b>34</b>, 
38--45.</p>  
<p>Schabenberger, O. (2004) Mixed Model Influence Diagnostics,
in <em>Proceedings of the Twenty-Ninth SAS Users Group International Conference</em>,
SAS Users Group International.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='leverage.default.html'>leverage.mer</a></code>,
<code><a href='covratio.default.html'>covratio.mer</a></code>, <code><a href='covratio.default.html'>covtrace.mer</a></code>, <code><a href='rvc.default.html'>rvc.mer</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Adam Loy <a href='mailto:loyad01@gmail.com'>loyad01@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>sleepstudy</span>, package <span class='op'>=</span> <span class='st'>'lme4'</span><span class='op'>)</span>
<span class='va'>ss</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>Reaction</span> <span class='op'>~</span> <span class='va'>Days</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>Days</span> <span class='op'>|</span> <span class='va'>Subject</span><span class='op'>)</span>, <span class='va'>sleepstudy</span><span class='op'>)</span>

<span class='co'># Cook's distance for individual observations</span>
<span class='va'>ss.cd.lev1</span> <span class='op'>&lt;-</span> <span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>ss</span><span class='op'>)</span>

<span class='co'># Cook's distance for each Subject</span>
<span class='va'>ss.cd.subject</span> <span class='op'>&lt;-</span> <span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>ss</span>, level <span class='op'>=</span> <span class='st'>"Subject"</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Exam</span>, package <span class='op'>=</span> <span class='st'>'mlmRev'</span><span class='op'>)</span>
<span class='va'>fm</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>normexam</span> <span class='op'>~</span> <span class='va'>standLRT</span> <span class='op'>*</span> <span class='va'>schavg</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>standLRT</span> <span class='op'>|</span> <span class='va'>school</span><span class='op'>)</span>, <span class='va'>Exam</span><span class='op'>)</span>

<span class='co'># Cook's distance for individual observations</span>
<span class='va'>cd.lev1</span> <span class='op'>&lt;-</span> <span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>

<span class='co'># Cook's distance for each school</span>
<span class='va'>cd.school</span> <span class='op'>&lt;-</span> <span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>fm</span>, level <span class='op'>=</span> <span class='st'>"school"</span><span class='op'>)</span>

<span class='co'># Cook's distance when school 1 is deleted</span>
<span class='va'>cd.school1</span> <span class='op'>&lt;-</span> <span class='fu'>cooks.distance</span><span class='op'>(</span><span class='va'>fm</span>, level <span class='op'>=</span> <span class='st'>"school"</span>, delete <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='op'>}</span>


<span class='co'># MDFFITS  for individual observations</span>
<span class='va'>ss.m1</span> <span class='op'>&lt;-</span> <span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>ss</span><span class='op'>)</span>

<span class='co'># MDFFITS for each Subject</span>
<span class='va'>ss.m.subject</span> <span class='op'>&lt;-</span> <span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>ss</span>, level <span class='op'>=</span> <span class='st'>"Subject"</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>  

<span class='co'># MDFFITS  for individual observations</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>fm</span><span class='op'>)</span>

<span class='co'># MDFFITS for each school</span>
<span class='va'>m.school</span> <span class='op'>&lt;-</span> <span class='fu'>mdffits</span><span class='op'>(</span><span class='va'>fm</span>, level <span class='op'>=</span> <span class='st'>"school"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Adam Loy, Jaylin Lowe, Jack Moran.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


